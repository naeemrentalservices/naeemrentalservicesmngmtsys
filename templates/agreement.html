{% extends 'base.html' %}

{% block title %}Agreement Generator - Naeem Rental Services{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h2">Rental Agreement Generator</h1>
    </div>

    <div class="card">
        <div class="card-header">
            <i class="bi bi-file-earmark-text me-2"></i> Agreement Document
        </div>
        <div class="card-body">

            {% if error %}
            <div class="alert alert-danger">
                <p>Error loading agreement document: {{ error }}</p>
            </div>
            {% else %}
            <div class="mb-4">
                <iframe src="https://docs.google.com/document/d/{{ doc_id }}/edit?usp=sharing&embedded=true" 
                        style="width: 100%; height: 600px; border: 1px solid #ddd; border-radius: 8px;" 
                        frameborder="0"></iframe>
            </div>

            <div class="d-flex gap-2">
                <a href="https://docs.google.com/document/d/{{ doc_id }}/export?format=docx" class="btn btn-primary">
                    <i class="bi bi-download me-1"></i> Download as DOCX
                </a>
                
                <a href="https://docs.google.com/document/d/{{ doc_id }}/export?format=pdf" class="btn btn-secondary">
                    <i class="bi bi-file-pdf me-1"></i> Download as PDF
                </a>
                
                <a href="https://docs.google.com/document/d/{{ doc_id }}/edit?usp=sharing" target="_blank" class="btn btn-info">
                    <i class="bi bi-pencil me-1"></i> Edit in Google Docs
                </a>
                
                <button onclick="window.open('https://docs.google.com/document/d/{{ doc_id }}/edit?usp=sharing').print()" class="btn btn-outline-dark">
                    <i class="bi bi-printer me-1"></i> Print
                </button>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}